# Инструкция по запуску проекта Image-Dedup на Windows

Эта инструкция поможет вам настроить и запустить проект на операционной системе Windows 10/11.

## Шаг 1: Установка необходимого ПО

Перед началом работы убедитесь, что у вас установлены:

1.  **Python 3.11+**:
    *   Скачайте установщик с [официального сайта Python](https://www.python.org/downloads/).
    *   **Важно:** Во время установки обязательно поставьте галочку **"Add Python to PATH"**.

2.  **Git**:
    *   Скачайте и установите [Git for Windows](https://git-scm.com/download/win). Это предоставит вам необходимые инструменты для работы с репозиторием.

3.  **Docker Desktop for Windows (если нужна локальная БД)**:
    *   Скачайте и установите [Docker Desktop](https://www.docker.com/products/docker-desktop/).
    *   **Важно:** Docker Desktop требует включенной виртуализации в BIOS/UEFI и, как правило, использует WSL 2 (Windows Subsystem for Linux). Установщик поможет вам настроить WSL 2, если это необходимо.

## Шаг 2: Настройка проекта

1.  **Клонирование репозитория:**
    Откройте **PowerShell** или **Command Prompt (cmd)** и выполните следующие команды:

    ```powershell
    # Клонируем проект
    git clone https://github.com/your-repo/image-dedup.git
    
    # Переходим в папку проекта
    cd image-dedup
    ```

2.  **Создание и активация виртуального окружения:**
    Это изолирует зависимости проекта от вашей системы.

    ```powershell
    # Создаем виртуальное окружение
    python -m venv .venv
    
    # Активируем его
    .\.venv\Scripts\Activate.ps1
    ```
    После активации в начале строки терминала появится `(.venv)`.

## Шаг 3: Установка зависимостей

Установка будет проходить в несколько этапов из-за специфики некоторых пакетов.

1.  **Установка PyTorch (CPU-версия):**
    Проект использует `torch`, который имеет сложную установку. Мы установим CPU-версию, так как она не требует настройки NVIDIA CUDA.

    ```powershell
    # Устанавливаем PyTorch и TorchVision для CPU
    pip install torch==2.1.0 torchvision==0.16.0 --index-url https://download.pytorch.org/whl/cpu
    ```

2.  **Установка остальных зависимостей:**
    Теперь установим все остальные пакеты из файла `requirements.txt`.

    ```powershell
    # Устанавливаем остальные пакеты
    pip install -r requirements.txt
    ```
    *Если возникнут ошибки, связанные с `faiss-cpu`, убедитесь, что у вас установлены Microsoft C++ Build Tools (их можно установить через Visual Studio Installer).*

## Шаг 4: Запуск базы данных

1.  Убедитесь, что **Docker Desktop** запущен.
2.  В терминале, находясь в корневой папке проекта, выполните команду:

    ```powershell
    docker-compose up -d
    ```
    Эта команда скачает образ PostgreSQL с расширением `pgvector` и запустит его в фоновом режиме. Убедитесь, что порт `5432` на вашем компьютере свободен.

## Шаг 5: Инициализация и использование приложения

Теперь, когда все настроено, вы можете использовать приложение так же, как и в Linux.

1.  **Инициализация базы данных (выполняется один раз):**

    ```powershell
    python -m src.main init
    ```

2.  **Индексация изображений:**
    Укажите путь к вашей папке с изображениями. Для Windows используйте пути в соответствующем формате.

    ```powershell
    # Пример для папки 'D:\Photos'
    python -m src.main index D:\Photos
    ```

3.  **Кластеризация:**

    ```powershell
    python -m src.main cluster
    ```

4.  **Ручной разбор в GUI:**

    ```powershell
    python -m src.main review
    ```

После выполнения этих шагов проект должен успешно работать на вашей Windows-системе.